var PanelResources=Panel.extend({init:function(){this.id="resources";this._super()},setup:function(p_data){var scope=this,l_groups=$.makeArray(p_data),g_count=l_groups.length,$panel=$("#panel-resources"),$content=$panel.find(".panel-content"),$inner=$$("div","","inner"),$panelTabs=$panel.find(".panel-tabs").empty(),l_firstTab="";this.$essential=$$("div","essential-content");this.$links=$$("div","links-content");this.$glossary=$$("div","glossary-content");this.$faq=$$("div","faq-content");this.$panel.off("click");this.$button.removeClass("has_essential");for(var i=0;i<g_count;i++){switch(l_groups[i].type){case"essential":this.setupEssentialInfo(l_groups[i]);break;case"review":this.setupReviewLinks(l_groups[i]);break;case"other":this.setupOtherLinks(l_groups[i]);break;case"mp_glossary":this.setupGlossary(l_groups[i]);break;case"mp_faq":this.setupFAQ(l_groups[i]);break}}if(this.$essential.html().length>0){$panelTabs.append($$("a","tab-essential","tab",{href:"#"}).html("Essential Information"));l_firstTab="tab-essential"}if(this.$links.html().length>0){$panelTabs.append($$("a","tab-links","tab",{href:"#"}).html("Links"));if(empty(l_firstTab))l_firstTab="tab-links"}if(this.$glossary.html().length>0){$panelTabs.append($$("a","tab-glossary","tab",{href:"#"}).html("Glossary"));if(empty(l_firstTab))l_firstTab="tab-glossary"}if(this.$faq.html().length>0){$panelTabs.append($$("a","tab-faq","tab",{href:"#"}).html("FAQs"));if(empty(l_firstTab))l_firstTab="tab-faq"}$panel.find(".tab").bind("click",function(p_event){$inner.empty();$panel.find(".tab").removeClass("selected");switch(p_event.target.id){case"tab-essential":$inner.html(scope.$essential);$(p_event.target).addClass("selected");break;case"tab-links":$inner.html(scope.$links);$(p_event.target).addClass("selected");break;case"tab-glossary":$inner.html(scope.$glossary);$(p_event.target).addClass("selected");break;case"tab-faq":$inner.html(scope.$faq);$(p_event.target).addClass("selected");break}$content.html($inner);return false});$("#"+l_firstTab).trigger("click");this._super()},setupEssentialInfo:function(p_data){var scope=this,l_resources=$.makeArray(p_data.item),l_count=l_resources.length,$resource=[],l_link="",l_description="",l_iconName="";for(var i=0;i<l_count;i++){switch(l_resources[i].type){case"essential":l_link="";l_description=l_resources[i].content;l_iconName="icon-alert";break;case"mp_resource_image":l_link="files/"+l_resources[i].content;l_description=l_resources[i].alt_text;l_iconName="icon-image";break;case"mp_resource_video":if(Number(l_resources[i].streaming)){l_link=l_resources[i].address}else{l_link="files/"+l_resources[i].content}l_description=l_resources[i].description;l_iconName="icon-video";break;case"mp_resource_web":l_link=l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-earth";break;case"mp_resource_audio":l_link="files/"+l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-audio";break;default:l_link="files/"+l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-file-text";break}$resource=$$("div","essential-"+i,"resource "+l_resources[i].ext).append($$("div","","icon "+l_iconName)).append($$("div","","info").append($$("div","","title").html(l_resources[i].title)).append($$("div","","description").html(l_description)).append($$("a","","url",{href:l_link,target:"_blank"}).html(l_link)));this.$essential.append($resource)}this.$panel.on("click","#essential-content",function(p_event){var $target=$(p_event.target),l_file="",l_type="",$resource=[],l_id="";if($target.is("a")){l_file=$target.attr("href");l_type=l_file.split(".").pop();if(l_file.indexOf("vimeo")||l_file.indexOf("youtube")){l_type="mp4"}switch(l_type){case"mp3":case"mp4":$resource=$target.parents(".resource");l_id=$resource.attr("id").split("-").pop();scope.openResource(l_resources[l_id]);p_event.preventDefault();break}}});this.$button.addClass("has_essential")},setupReviewLinks:function(p_data){var scope=this,l_resources=$.makeArray(p_data.item),l_count=l_resources.length,$review=$$("div","resources-review"),$resource=[],l_link="",l_description="",l_iconName="";for(var i=0;i<l_count;i++){l_iconName="";switch(l_resources[i].type){case"mp_resource_image":l_link="files/"+l_resources[i].content;l_description=l_resources[i].alt_text;l_iconName="icon-image";break;case"mp_resource_video":if(Number(l_resources[i].streaming)){l_link=l_resources[i].address}else{l_link="files/"+l_resources[i].content}l_description=l_resources[i].description;l_iconName="icon-video";break;case"mp_resource_web":l_link=l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-earth";break;case"mp_resource_audio":l_link="files/"+l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-audio";break;default:l_link="files/"+l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-file-text";break}$resource=$$("div","review-"+i,"resource "+l_resources[i].ext).append($$("span","","icon "+l_iconName)).append($$("div","","info").append($$("h4","","title").html(l_resources[i].title)).append($$("div","","description").html(l_description)).append($$("a","","url",{href:l_link,target:"_blank"}).html(l_link)));$review.append($resource)}this.$links.append($review);this.$panel.on("click","#resources-review",function(p_event){var $target=$(p_event.target),l_file="",l_type="",$resource=[],l_id="";if($target.is("a")){l_file=$target.attr("href");l_type=l_file.split(".").pop();if(l_file.indexOf("vimeo")||l_file.indexOf("youtube")){l_type="mp4"}switch(l_type){case"mp3":case"mp4":$resource=$target.parents(".resource");l_id=$resource.attr("id").split("-").pop();scope.openResource(l_resources[l_id]);p_event.preventDefault();break}}})},setupOtherLinks:function(p_data){var scope=this,l_resources=$.makeArray(p_data.item),l_count=l_resources.length,$other=$$("div","resources-other").append($$("h2").html("You might also be interested in...")),$resource=[],l_link="",l_description="",l_iconName="";for(var i=0;i<l_count;i++){switch(l_resources[i].type){case"mp_resource_image":l_link="files/"+l_resources[i].content;l_description=l_resources[i].alt_text;l_iconName="icon-image";break;case"mp_resource_video":if(l_resources[i].streaming==1){l_link=l_resources[i].address}else{l_link="files/"+l_resources[i].content}l_description=l_resources[i].description;l_iconName="icon-video";break;case"mp_resource_web":l_link=l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-earth";break;case"mp_resource_audio":l_link="files/"+l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-audio";break;default:l_link="files/"+l_resources[i].content;l_description=l_resources[i].description;l_iconName="icon-file-text";break}$resource=$$("div","other-"+i,"resource "+l_resources[i].ext).append($$("div","","icon "+l_iconName)).append($$("div","","info").append($$("h4","","title").html(l_resources[i].title)).append($$("div","","description").html(l_description)).append($$("a","","url",{href:l_link,target:"_blank"}).html(l_link)));$other.append($resource)}this.$links.append($other);this.$panel.on("click","#resources-other",function(p_event){var $target=$(p_event.target),l_file="",l_type="",$resource=[],l_id="";if($target.is("a")){l_file=$target.attr("href");l_type=l_file.split(".").pop();if(l_file.indexOf("vimeo")||l_file.indexOf("youtube")){l_type="mp4"}switch(l_type){case"mp3":case"mp4":$resource=$target.parents(".resource");l_id=$resource.attr("id").split("-").pop();scope.openResource(l_resources[l_id]);p_event.preventDefault();break}}})},setupGlossary:function(p_data){var l_items=$.makeArray(p_data.item),l_count=l_items.length,$item=[];for(var i=0;i<l_count;i++){$item=$$("div","","item");$item.append($$("h4").html(l_items[i].term)).append(l_items[i].definition);this.$glossary.append($item)}},setupFAQ:function(p_data){var l_items=$.makeArray(p_data.item),l_count=l_items.length,$content=$$("ul");for(var i=0;i<l_count;i++){$content.append($$("li","","item").append($$("a","","question").attr({href:"#","aria-expanded":"false"}).append(l_items[i].question)).append($$("div","","answer hidden").html(l_items[i].answer)))}this.$faq.append($content);$("#panel-resources").on("click","#faq-content",function(p_event){var $target=$(p_event.target),$parent=[];if($target.is("a")){$parent=$target.parent();if($parent.hasClass("open")){$parent.find(".answer").slideUp();$parent.removeClass("open");$target.attr("aria-expanded","false")}else{$parent.find(".answer").slideDown();$parent.addClass("open");$target.attr("aria-expanded","true")}p_event.preventDefault()}})},openResource:function(p_resource){var $content=[],l_dimensions={},l_description="",l_media={},l_playerId="resource-media-"+$.randomString(6);switch(p_resource.type){case"mp_resource_audio":$content=$$("div","","resource").append($$("div",l_playerId,"resource-player"));if(p_resource.image){l_dimensions={width:200,height:273};l_description=p_resource.description||"";if(!empty(l_description)){$content.append($$("div").html(l_description).transcript("right",l_dimensions,l_playerId))}_app.modalOverlay(p_resource.title,$content).addClass("audio-resource");l_media=p_resource;l_media.width=485;l_media.height=273;_app.setupAudioPlayer(l_playerId,l_media,l_media.image)}else{l_dimensions={width:485,height:240};l_description=p_resource.description||"";if(!empty(l_description)){$content.append($$("div").html(l_description).transcript("down",l_dimensions,l_playerId))}_app.modalOverlay(p_resource.title,$content).addClass("audio-resource");l_media=p_resource;l_media.width=485;l_media.height=24;_app.setupAudioPlayer(l_playerId,l_media)}break;case"mp_resource_document":window.open("files/"+p_resource.content,"_blank");break;case"mp_resource_image":if(Number(p_resource.width)>690){l_ratio=690/p_resource.width;l_dimensions.width=p_resource.width*l_ratio;l_dimensions.height=p_resource.height*l_ratio}if(Number(p_resource.height)>340){l_ratio=340/p_resource.height;l_dimensions.width=p_resource.width*l_ratio;l_dimensions.height=p_resource.height*l_ratio}$content=$$("a").attr({href:"files/"+p_resource.content,target:"_blank"}).html($$("img").attr({src:"files/"+p_resource.content,alt:p_resource.alt_text,width:l_dimensions.width,height:l_dimensions.height}));_app.modalOverlay(p_resource.title,$content);break;case"mp_resource_video":$content=$$("div","","resource").append($$("div",l_playerId,"resource-player"));l_dimensions={width:200,height:273};l_description=p_resource.description||"";if(!empty(l_description)){$content.append($$("div").html(l_description).transcript("right",l_dimensions,l_playerId))}_app.modalOverlay(p_resource.title,$content).addClass("video-resource");l_media=p_resource;l_media.width=485;l_media.height=273;_app.setupVideoPlayer(l_playerId,l_media);break;case"mp_resource_web":window.open(p_resource.content,"_blank");break}}});