var mp_splash=PageType.extend({setup:function(){this.initial=true;this.slides=[];var scope=this,$slides=$$("div","slides"),$slide=[],l_slide={},l_imgClass="showing",l_slides=$.makeArray(scope.data.slides.slide),l_slideCount=l_slides.length,$courseTitle=$$("div","course-title"),$copyright=$$("p"),$start=$$("a","btn-start","button").attr({href:"",role:"button"}).html("Start");for(var i=0;i<l_slideCount;i++){if(i>0){l_imgClass="hidden"}$slide=$$("img","slide-"+i,l_imgClass,{src:"files/"+l_slides[i].image,alt:l_slides[i].alt_text,width:l_slides[i].width,height:l_slides[i].height});l_slide=new Image;l_slide.src="files/"+l_slides[i].image;this.slides.push(l_slide);$slides.append($slide)}this.html.append($courseTitle.append($$("div","splash-logo")).append($$("h1").html(_app.structure.course.title)));if(_app.structure.course.module_title&&_app.structure.course.module_title!==""){this.html.append($$("h2","module-title").html(_app.structure.course.module_title))}if(!empty(this.data.credits)){$copyright.append($$("a","credits").attr("href","#").html(this.data.credits_link||"Acknowledgements and Credits"))}$copyright.append(_app.structure.course.copyright);this.html.append($slides).append($$("div","copyright-splash").html($copyright)).append($start);this._super()},pageReady:function(){this._super();var scope=this,$credits=$("#credits"),$start=$("#btn-start"),l_slides=$.makeArray(this.data.slides.slide),l_slidesLength=l_slides.length,l_creditsLink=this.data.credits_link||"Acknowledgements and Credits";if(l_slidesLength>1){this.showImage(1)}$start.click(function(p_event){_app.sequence.next();$credits.remove();setTimeout(function(){$(window).trigger("resize")},500);p_event.preventDefault()});$credits.click(function(p_event){_app.modalOverlay(l_creditsLink,scope.data.credits);p_event.preventDefault()})},showImage:function(p_index){var scope=this,l_next=p_index+1,l_duration=5e3,l_transition=2e3;setTimeout(function(){if(scope.slides[p_index].complete){_app.$content.find("#slides").find(".showing").fadeOut(l_transition,function(){$(this).removeClass("showing")});_app.$content.find("#slide-"+p_index).fadeIn(l_transition+20,function(){$(this).addClass("showing")});if(l_next>=scope.slides.length){l_next=0}scope.showImage(l_next)}else{}},l_duration)},resizePage:function(){var $body=$("body"),$title=_app.$content.find("#course-title"),$h1=$title.find("h1"),$logo=$title.find("#splash-logo"),l_logoWidth=$logo.width(),l_titleMargin=$h1.outerWidth(true)-$h1.outerWidth(),$slides=_app.$content.find("#slides"),l_width=$body.width(),l_height=$body.height(),l_maxWidth=l_width,$copyright=_app.$content.find("#copyright-splash"),l_maxHeight=_app.dimensions.height-$title.height()-$copyright.height();_app.$content.css({width:l_width,height:l_height});$h1.css({marginTop:($title.height()-$h1.height())/2,width:l_width-l_titleMargin-l_logoWidth-5});$slides.height(l_maxHeight).find("img").scaleDimensions({width:l_maxWidth,height:l_maxHeight,fill:true})}});